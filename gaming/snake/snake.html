<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Snake Game</title>
  <style>
    :root{--bg:#0f1724;--panel:#071028;--accent:#10b981;--danger:#ef4444;--muted:#94a3b8}
    *{box-sizing:border-box;font-family:Inter,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{margin:0;min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#051622 0%, #0b1b2b 100%);color:#e6eef6}
    .wrap{width:520px;max-width:96vw;padding:18px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);box-shadow:0 10px 30px rgba(2,6,23,0.6);display:grid;grid-template-columns:1fr 180px;gap:14px}
    .panel{background:var(--panel);padding:12px;border-radius:8px}
    header{display:flex;align-items:center;gap:8px;margin-bottom:10px}
    h1{font-size:16px;margin:0}
    canvas{display:block;background:linear-gradient(180deg,#021627,#052236);border-radius:8px;width:100%;height:auto;}
    .controls{display:flex;flex-direction:column;gap:8px}
    .stat{display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:6px;background:rgba(255,255,255,0.02);font-size:14px}
    .btn{padding:8px 10px;border-radius:6px;border:0;background:var(--accent);color:#052022;font-weight:600;cursor:pointer}
    .btn.secondary{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
    .hint{font-size:12px;color:var(--muted);margin-top:6px}
    .footer{font-size:12px;color:var(--muted);margin-top:8px}
    @media(max-width:700px){.wrap{grid-template-columns:1fr}} 
  </style>
</head>
<body>
  <div class="wrap">
    <div class="panel">
      <header>
        <h1>Snake â€” HTML5 Canvas</h1>
      </header>

      <canvas id="game" width="400" height="400"></canvas>
      <div class="hint">Use arrow keys / WASD. Tap on-screen controls on mobile or swipe.</div>
    </div>

    <div class="panel controls">
      <div class="stat"><span>Score</span><strong id="score">0</strong></div>
      <div class="stat"><span>High Score</span><strong id="high">0</strong></div>
      <div class="stat"><span>Speed</span><strong id="spd">8</strong></div>

      <div style="display:flex;gap:8px">
        <button id="startBtn" class="btn">Start</button>
        <button id="pauseBtn" class="btn secondary">Pause</button>
      </div>

      <div style="display:flex;gap:8px;margin-top:8px">
        <button id="faster" class="btn secondary">Faster</button>
        <button id="slower" class="btn secondary">Slower</button>
      </div>

      <div class="footer">Controls: Arrow keys / WASD. Mobile: swipe to change direction.</div>

      <div style="margin-top:10px">
        <button id="resetHigh" class="btn secondary">Reset High Score</button>
      </div>
    </div>
  </div>

  <script>
    // --- Game settings ---
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const scoreEl = document.getElementById('score');
    const highEl = document.getElementById('high');
    const spdEl = document.getElementById('spd');
    const startBtn = document.getElementById('startBtn');
    const pauseBtn = document.getElementById('pauseBtn');
    const fasterBtn = document.getElementById('faster');
    const slowerBtn = document.getElementById('slower');
    const resetHighBtn = document.getElementById('resetHigh');

    const gridSize = 20;              // size of a cell in pixels
    const cols = canvas.width / gridSize; // 20 if 400/20
    const rows = canvas.height / gridSize;

    let snake = [];
    let dir = {x: 1, y: 0};
    let nextDir = {x: 1, y: 0};
    let food = null;
    let score = 0;
    let high = parseInt(localStorage.getItem('snakeHigh')||'0',10);
    let speed = 8; // ticks per second
    let running = false;
    let paused = false;
    let tickTimer = null;

    highEl.textContent = high;
    spdEl.textContent = speed;

    function resetGame(){
      snake = [{x: Math.floor(cols/2), y: Math.floor(rows/2)}];
      dir = {x:1,y:0}; nextDir = {x:1,y:0};
      placeFood();
      score = 0;
      scoreEl.textContent = score;
    }

    function placeFood(){
      while(true){
        const f = {x: Math.floor(Math.random()*cols), y: Math.floor(Math.random()*rows)};
        if(!snake.some(s=>s.x===f.x && s.y===f.y)) { food = f; break; }
      }
    }

    function draw(){
      // background
      ctx.fillStyle = '#031826';
      ctx.fillRect(0,0,canvas.width,canvas.height);

      // grid (subtle)
      ctx.strokeStyle = 'rgba(255,255,255,0.02)';
      ctx.lineWidth = 1;
      for(let i=0;i<=cols;i++){
        ctx.beginPath(); ctx.moveTo(i*gridSize,0); ctx.lineTo(i*gridSize,canvas.height); ctx.stroke();
      }
      for(let j=0;j<=rows;j++){
        ctx.beginPath(); ctx.moveTo(0,j*gridSize); ctx.lineTo(canvas.width,j*gridSize); ctx.stroke();
      }

      // food
      ctx.fillStyle = '#ef4444';
      ctx.fillRect(food.x*gridSize+3, food.y*gridSize+3, gridSize-6, gridSize-6);

      // snake
      for(let i=0;i<snake.length;i++){
        const s = snake[i];
        ctx.fillStyle = i===0 ? '#10b981' : 'rgba(16,185,129,' + (0.4 + 0.6*(1 - i/snake.length)) + ')';
        ctx.fillRect(s.x*gridSize+1, s.y*gridSize+1, gridSize-2, gridSize-2);
      }
    }

    function step(){
      if(paused) return;
      dir = nextDir; // commit queued direction
      const head = {x: snake[0].x + dir.x, y: snake[0].y + dir.y};

      // wall collision -> game over
      if(head.x < 0 || head.x >= cols || head.y < 0 || head.y >= rows){
        gameOver(); return;
      }

      // self collision
      if(snake.some(s => s.x===head.x && s.y===head.y)) { gameOver(); return; }

      snake.unshift(head);

      // ate food?
      if(head.x === food.x && head.y === food.y){
        score += 10;
        scoreEl.textContent = score;
        placeFood();
      } else {
        snake.pop();
      }

      draw();
    }

    function gameOver(){
      running = false;
      clearInterval(tickTimer);
      alert('Game Over! Score: ' + score);
      if(score > high){ high = score; localStorage.setItem('snakeHigh', String(high)); highEl.textContent = high; }
    }

    function start(){
      if(running) return;
      resetGame();
      running = true; paused = false;
      tickTimer = setInterval(step, 1000 / speed);
    }

    function pauseToggle(){
      if(!running) return;
      paused = !paused;
      pauseBtn.textContent = paused ? 'Resume' : 'Pause';
    }

    function changeSpeed(delta){
      speed = Math.max(2, Math.min(24, speed + delta));
      spdEl.textContent = speed;
      if(running){ clearInterval(tickTimer); tickTimer = setInterval(step, 1000 / speed); }
    }

    // keyboard
    window.addEventListener('keydown', e => {
      if(['ArrowUp','ArrowDown','ArrowLeft','ArrowRight','w','a','s','d','W','A','S','D'].includes(e.key)){
        e.preventDefault();
      }
      switch(e.key){
        case 'ArrowUp': case 'w': case 'W': if(dir.y!==1) nextDir = {x:0,y:-1}; break;
        case 'ArrowDown': case 's': case 'S': if(dir.y!==-1) nextDir = {x:0,y:1}; break;
        case 'ArrowLeft': case 'a': case 'A': if(dir.x!==1) nextDir = {x:-1,y:0}; break;
        case 'ArrowRight': case 'd': case 'D': if(dir.x!==-1) nextDir = {x:1,y:0}; break;
        case ' ': pauseToggle(); break;
      }
    });

    // simple mobile swipe detection
    let touchStart = null;
    canvas.addEventListener('touchstart', e => { touchStart = e.touches[0]; });
    canvas.addEventListener('touchend', e => {
      if(!touchStart) return; const t = e.changedTouches[0];
      const dx = t.clientX - touchStart.clientX; const dy = t.clientY - touchStart.clientY;
      if(Math.abs(dx) > Math.abs(dy)){
        if(dx > 10 && dir.x!==-1) nextDir = {x:1,y:0};
        else if(dx < -10 && dir.x!==1) nextDir = {x:-1,y:0};
      } else {
        if(dy > 10 && dir.y!==-1) nextDir = {x:0,y:1};
        else if(dy < -10 && dir.y!==1) nextDir = {x:0,y:-1};
      }
      touchStart = null;
    });

    // UI buttons
    startBtn.addEventListener('click', ()=>{ start(); });
    pauseBtn.addEventListener('click', ()=>{ pauseToggle(); });
    fasterBtn.addEventListener('click', ()=>{ changeSpeed(2); });
    slowerBtn.addEventListener('click', ()=>{ changeSpeed(-2); });
    resetHighBtn.addEventListener('click', ()=>{ localStorage.removeItem('snakeHigh'); high = 0; highEl.textContent = high; });

    // draw initial
    resetGame(); draw();

  </script>
</body>
</html>
